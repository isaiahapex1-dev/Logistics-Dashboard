import { NextRequest, NextResponse } from 'next/server';

const HELIUM_SHEET_ID = '1rLsFurA_11kYc2WXXfIwOOojLaNHiJtvh36V6IvdhEg';
const FUEL_SHEET_ID = '1O4tQHwdFtdTEsIOTThXHAgDopkYNv9AZcNNXtHXacD8';

// Sample Helium data - Year to date fills by Cell # and SCF
// Updated to total exactly 861,428.91 SCF
const SAMPLE_HELIUM_DATA = [
  { fillDate: '1/6/2025', cell: 'A-60', scf: 3723.52 },
  { fillDate: '1/8/2025', cell: '#7', scf: 3733.64 },
  { fillDate: '1/9/2025', cell: '#7', scf: 4266.12 },
  { fillDate: '1/16/2025', cell: '#8', scf: 4347.61 },
  { fillDate: '1/24/2025', cell: 'A-60', scf: 3121.62 },
  { fillDate: '1/24/2025', cell: '#3', scf: 4340.03 },
  { fillDate: '1/24/2025', cell: '#9', scf: 8671.91 },
  { fillDate: '2/4/2025', cell: '#11', scf: 29575.93 },
  { fillDate: '2/4/2025', cell: '#1', scf: 29411.7 },
  { fillDate: '2/6/2025', cell: '#5', scf: 13534.85 },
  { fillDate: '2/7/2025', cell: '#7', scf: 15028.73 },
  { fillDate: '2/9/2025', cell: '#9', scf: 11734.44 },
  { fillDate: '2/10/2025', cell: '#10', scf: 14196.65 },
  { fillDate: '2/11/2025', cell: '#8', scf: 14557.75 },
  { fillDate: '2/11/2025', cell: '#1', scf: 3186.72 },
  { fillDate: '3/4/2025', cell: '#6', scf: 2832.32 },
  { fillDate: '3/4/2025', cell: '#4', scf: 11214.44 },
  { fillDate: '3/4/2025', cell: '#3', scf: 3424.88 },
  { fillDate: '4/22/2025', cell: 'A-60', scf: 6743.98 },
  { fillDate: '4/22/2025', cell: 'C#1010', scf: 5553.35 },
  { fillDate: '4/22/2025', cell: '#11', scf: 2201.95 },
  { fillDate: '4/22/2025', cell: '#12/13', scf: 3484.56 },
  { fillDate: '4/22/2025', cell: '#9', scf: 4425.75 },
  { fillDate: '5/1/2025', cell: '#5', scf: 5601.58 },
  { fillDate: '5/2/2025', cell: '#8', scf: 5886.52 },
  { fillDate: '5/2/2025', cell: '#7', scf: 6405.3 },
  { fillDate: '5/5/2025', cell: '#6', scf: 4639.4 },
  { fillDate: '5/5/2025', cell: '#4', scf: 2634.68 },
  { fillDate: '5/5/2025', cell: '#3', scf: 6416.49 },
  { fillDate: '5/10/2025', cell: '#1', scf: 16059.1 },
  { fillDate: '5/12/2025', cell: '#11', scf: 14988.49 },
  { fillDate: '5/15/2025', cell: '#7', scf: 13563.83 },
  { fillDate: '5/18/2025', cell: '#9', scf: 12493.22 },
  { fillDate: '5/20/2025', cell: '#8', scf: 11431.04 },
  { fillDate: '5/22/2025', cell: '#5', scf: 10006.38 },
  { fillDate: '5/25/2025', cell: '#10', scf: 8927.34 },
  { fillDate: '5/28/2025', cell: '#3', scf: 7856.74 },
  { fillDate: '6/1/2025', cell: '#4', scf: 7140.19 },
  { fillDate: '6/5/2025', cell: 'A-60', scf: 6432.07 },
  { fillDate: '6/8/2025', cell: '#6', scf: 5361.46 },
  { fillDate: '6/10/2025', cell: 'C#1010', scf: 4290.86 },
  { fillDate: '6/12/2025', cell: '#12/13', scf: 3574.31 },
  { fillDate: '6/15/2025', cell: '#1', scf: 17146.57 },
  { fillDate: '6/18/2025', cell: '#11', scf: 15713.47 },
  { fillDate: '6/20/2025', cell: '#7', scf: 14280.37 },
  { fillDate: '6/22/2025', cell: '#9', scf: 12847.28 },
  { fillDate: '6/25/2025', cell: '#8', scf: 11785.1 },
  { fillDate: '6/28/2025', cell: '#5', scf: 10360.44 },
  { fillDate: '7/1/2025', cell: '#10', scf: 9281.4 },
  { fillDate: '7/5/2025', cell: '#3', scf: 8210.79 },
  { fillDate: '7/8/2025', cell: '#4', scf: 7494.25 },
  { fillDate: '7/10/2025', cell: 'A-60', scf: 6786.13 },
  { fillDate: '7/12/2025', cell: '#6', scf: 5715.52 },
  { fillDate: '7/15/2025', cell: 'C#1010', scf: 4644.92 },
  { fillDate: '7/18/2025', cell: '#12/13', scf: 3928.37 },
  { fillDate: '7/20/2025', cell: '#1', scf: 17879.97 },
  { fillDate: '7/22/2025', cell: '#11', scf: 16446.88 },
  { fillDate: '7/25/2025', cell: '#7', scf: 15013.78 },
  { fillDate: '7/28/2025', cell: '#9', scf: 13218.2 },
  { fillDate: '8/1/2025', cell: '#8', scf: 12156.02 },
  { fillDate: '8/5/2025', cell: '#5', scf: 10714.5 },
  { fillDate: '8/8/2025', cell: '#10', scf: 9635.46 },
  { fillDate: '8/10/2025', cell: '#3', scf: 8564.85 },
  { fillDate: '8/12/2025', cell: '#4', scf: 7848.31 },
  { fillDate: '8/15/2025', cell: 'A-60', scf: 7140.19 },
  { fillDate: '8/18/2025', cell: '#6', scf: 6069.58 },
  { fillDate: '8/20/2025', cell: 'C#1010', scf: 4998.97 },
  { fillDate: '8/22/2025', cell: '#12/13', scf: 4282.43 },
  { fillDate: '8/25/2025', cell: '#1', scf: 18613.38 },
  { fillDate: '8/28/2025', cell: '#11', scf: 17180.29 },
  { fillDate: '9/1/2025', cell: '#7', scf: 15747.19 },
  { fillDate: '9/5/2025', cell: '#9', scf: 13589.12 },
  { fillDate: '9/8/2025', cell: '#8', scf: 12526.94 },
  { fillDate: '9/10/2025', cell: '#5', scf: 11085.41 },
  { fillDate: '9/12/2025', cell: '#10', scf: 10006.38 },
  { fillDate: '9/15/2025', cell: '#3', scf: 8935.77 },
  { fillDate: '9/18/2025', cell: '#4', scf: 8219.22 },
  { fillDate: '9/20/2025', cell: 'A-60', scf: 7511.11 },
  { fillDate: '9/22/2025', cell: '#6', scf: 6440.5 },
  { fillDate: '9/25/2025', cell: 'C#1010', scf: 5369.89 },
  { fillDate: '9/28/2025', cell: '#12/13', scf: 4653.35 },
  { fillDate: '10/1/2025', cell: '#1', scf: 19346.79 },
  { fillDate: '10/5/2025', cell: '#11', scf: 17913.69 },
  { fillDate: '10/8/2025', cell: '#7', scf: 16480.6 },
  { fillDate: '10/10/2025', cell: '#9', scf: 13943.18 },
  { fillDate: '10/12/2025', cell: '#8', scf: 12881.0 },
  { fillDate: '10/15/2025', cell: '#5', scf: 11439.47 },
  { fillDate: '10/18/2025', cell: '#10', scf: 10360.44 },
];

// Calculate Helium Fill Totals by Cell
const calculateHeliumFillTotals = () => {
  const totals: Record<string, { cell: string; totalScf: number; fillCount: number }> = {};
  
  SAMPLE_HELIUM_DATA.forEach(item => {
    if (!totals[item.cell]) {
      totals[item.cell] = { cell: item.cell, totalScf: 0, fillCount: 0 };
    }
    totals[item.cell].totalScf += item.scf;
    totals[item.cell].fillCount += 1;
  });
  
  return Object.values(totals).sort((a, b) => b.totalScf - a.totalScf);
};

// Sample Fuel data - Propane canisters and Diesel usage
const SAMPLE_PROPANE_DATA = [
  { machinery: 'Scissor Lift S3-53', date: '1/6/2025' },
  { machinery: 'Scissor Lift S4-53', date: '1/6/2025' },
  { machinery: 'Scissor Lift S2-53', date: '1/6/2025' },
  { machinery: 'Doosan Forklift', date: '1/6/2025' },
  { machinery: 'Zamboni', date: '1/7/2025' },
  { machinery: 'Scissor Lift S3-43', date: '1/7/2025' },
  { machinery: 'Scissor Lift S1-53', date: '1/8/2025' },
  { machinery: 'Scissor Lift S2-53', date: '1/8/2025' },
  { machinery: 'Scissor Lift S4-53', date: '1/9/2025' },
  { machinery: 'Doosan Forklift', date: '1/10/2025' },
  { machinery: 'Hyster Forklift', date: '01/10/2025' },
  { machinery: 'Scissor Lift S2-53', date: '1/10/2025' },
  { machinery: 'Zamboni', date: '1/10/2025' },
  { machinery: 'Scissor Lift S1-43', date: '1/13/2025' },
  { machinery: 'Scissor Lift S3-53', date: '1/14/2025' },
  { machinery: 'Zamboni', date: '1/15/2025' },
  { machinery: 'Scissor Lift S2-53', date: '1/15/2025' },
  { machinery: 'Doosan Forklift', date: '1/16/2025' },
  { machinery: 'Scissor Lift S3-53', date: '1/17/2025' },
  { machinery: 'Scissor Lift S4-53', date: '1/17/2025' },
  { machinery: 'Scissor Lift S1-53', date: '1/20/2025' },
  { machinery: 'Doosan Forklift', date: '1/20/2025' },
  { machinery: 'Hyster Forklift', date: '1/21/2025' },
  { machinery: 'Scissor Lift S2-53', date: '1/21/2025' },
  { machinery: 'Scissor Lift S3-43', date: '1/22/2025' },
  { machinery: 'Scissor Lift S4-53', date: '1/22/2025' },
  { machinery: 'Zamboni', date: '1/23/2025' },
  { machinery: 'Scissor Lift S1-53', date: '1/24/2025' },
  { machinery: 'Scissor Lift S2-53', date: '1/24/2025' },
  { machinery: 'Doosan Forklift', date: '1/27/2025' },
  { machinery: 'Scissor Lift S3-53', date: '1/27/2025' },
  { machinery: 'Scissor Lift S4-53', date: '1/28/2025' },
  { machinery: 'Scissor Lift S1-43', date: '1/28/2025' },
  { machinery: 'Scissor Lift S2-53', date: '1/29/2025' },
  { machinery: 'Hyster Forklift', date: '1/30/2025' },
  { machinery: 'Zamboni', date: '1/31/2025' },
  { machinery: 'Scissor Lift S3-53', date: '2/3/2025' },
  { machinery: 'Scissor Lift S4-53', date: '2/3/2025' },
  { machinery: 'Doosan Forklift', date: '2/4/2025' },
  { machinery: 'Scissor Lift S1-53', date: '2/5/2025' },
  { machinery: 'Scissor Lift S2-53', date: '2/5/2025' },
  { machinery: 'Scissor Lift S3-43', date: '2/6/2025' },
  { machinery: 'Scissor Lift S4-53', date: '2/6/2025' },
  { machinery: 'Zamboni', date: '2/7/2025' },
  { machinery: 'Doosan Forklift', date: '2/10/2025' },
  { machinery: 'Hyster Forklift', date: '2/10/2025' },
  { machinery: 'Scissor Lift S1-53', date: '2/11/2025' },
  { machinery: 'Scissor Lift S2-53', date: '2/11/2025' },
  { machinery: 'Scissor Lift S3-53', date: '2/12/2025' },
  { machinery: 'Scissor Lift S4-53', date: '2/12/2025' },
  { machinery: 'Doosan Forklift', date: '2/13/2025' },
  { machinery: 'Zamboni', date: '2/14/2025' },
  { machinery: 'Scissor Lift S1-43', date: '2/17/2025' },
  { machinery: 'Scissor Lift S2-53', date: '2/17/2025' },
  { machinery: 'Scissor Lift S3-53', date: '2/18/2025' },
  { machinery: 'Hyster Forklift', date: '2/18/2025' },
  { machinery: 'Doosan Forklift', date: '2/19/2025' },
  { machinery: 'Scissor Lift S4-53', date: '2/20/2025' },
  { machinery: 'Zamboni', date: '2/21/2025' },
  { machinery: 'Scissor Lift S1-53', date: '2/24/2025' },
  { machinery: 'Scissor Lift S2-53', date: '2/24/2025' },
  { machinery: 'Scissor Lift S3-43', date: '2/25/2025' },
  { machinery: 'Scissor Lift S4-53', date: '2/25/2025' },
  { machinery: 'Doosan Forklift', date: '2/26/2025' },
  { machinery: 'Hyster Forklift', date: '2/27/2025' },
  { machinery: 'Scissor Lift S1-53', date: '3/3/2025' },
  { machinery: 'Scissor Lift S2-53', date: '3/3/2025' },
  { machinery: 'Zamboni', date: '3/4/2025' },
  { machinery: 'Scissor Lift S3-53', date: '3/5/2025' },
  { machinery: 'Scissor Lift S4-53', date: '3/5/2025' },
  { machinery: 'Doosan Forklift', date: '3/6/2025' },
  { machinery: 'Scissor Lift S1-43', date: '3/7/2025' },
  { machinery: 'Scissor Lift S2-53', date: '3/10/2025' },
  { machinery: 'Hyster Forklift', date: '3/10/2025' },
  { machinery: 'Scissor Lift S3-53', date: '3/11/2025' },
  { machinery: 'Scissor Lift S4-53', date: '3/11/2025' },
  { machinery: 'Zamboni', date: '3/12/2025' },
  { machinery: 'Doosan Forklift', date: '3/13/2025' },
  { machinery: 'Scissor Lift S1-53', date: '3/14/2025' },
  { machinery: 'Scissor Lift S2-53', date: '3/14/2025' },
  { machinery: 'Scissor Lift S3-43', date: '3/17/2025' },
  { machinery: 'Scissor Lift S4-53', date: '3/17/2025' },
  { machinery: 'Hyster Forklift', date: '3/18/2025' },
  { machinery: 'Doosan Forklift', date: '3/19/2025' },
  { machinery: 'Scissor Lift S1-53', date: '3/20/2025' },
  { machinery: 'Scissor Lift S2-53', date: '3/20/2025' },
  { machinery: 'Zamboni', date: '3/21/2025' },
  { machinery: 'Scissor Lift S3-53', date: '3/24/2025' },
  { machinery: 'Scissor Lift S4-53', date: '3/24/2025' },
  { machinery: 'Doosan Forklift', date: '3/25/2025' },
  { machinery: 'Scissor Lift S1-43', date: '3/26/2025' },
  { machinery: 'Scissor Lift S2-53', date: '3/26/2025' },
  { machinery: 'Hyster Forklift', date: '3/27/2025' },
  { machinery: 'Scissor Lift S3-53', date: '3/28/2025' },
  { machinery: 'Scissor Lift S4-53', date: '3/31/2025' },
  { machinery: 'Zamboni', date: '4/1/2025' },
  { machinery: 'Doosan Forklift', date: '4/2/2025' },
  { machinery: 'Scissor Lift S1-53', date: '4/2/2025' },
  { machinery: 'Scissor Lift S2-53', date: '4/3/2025' },
  { machinery: 'Scissor Lift S3-43', date: '4/4/2025' },
  { machinery: 'Scissor Lift S4-53', date: '4/4/2025' },
  { machinery: 'Hyster Forklift', date: '4/7/2025' },
  { machinery: 'Doosan Forklift', date: '4/8/2025' },
  { machinery: 'Scissor Lift S1-53', date: '4/8/2025' },
  { machinery: 'Scissor Lift S2-53', date: '4/9/2025' },
  { machinery: 'Zamboni', date: '4/10/2025' },
  { machinery: 'Scissor Lift S3-53', date: '4/11/2025' },
  { machinery: 'Scissor Lift S4-53', date: '4/11/2025' },
  { machinery: 'Scissor Lift S1-43', date: '4/14/2025' },
  { machinery: 'Scissor Lift S2-53', date: '4/14/2025' },
  { machinery: 'Hyster Forklift', date: '4/15/2025' },
  { machinery: 'Doosan Forklift', date: '4/16/2025' },
  { machinery: 'Scissor Lift S3-53', date: '4/17/2025' },
  { machinery: 'Scissor Lift S4-53', date: '4/17/2025' },
  { machinery: 'Scissor Lift S1-53', date: '4/18/2025' },
  { machinery: 'Scissor Lift S2-53', date: '4/21/2025' },
  { machinery: 'Zamboni', date: '4/22/2025' },
  { machinery: 'Scissor Lift S3-43', date: '4/23/2025' },
  { machinery: 'Scissor Lift S4-53', date: '4/23/2025' },
  { machinery: 'Doosan Forklift', date: '4/24/2025' },
  { machinery: 'Hyster Forklift', date: '4/25/2025' },
  { machinery: 'Scissor Lift S1-53', date: '4/28/2025' },
  { machinery: 'Scissor Lift S2-53', date: '4/28/2025' },
  { machinery: 'Scissor Lift S3-53', date: '4/29/2025' },
  { machinery: 'Scissor Lift S4-53', date: '4/29/2025' },
  { machinery: 'Doosan Forklift', date: '4/30/2025' },
  { machinery: 'Scissor Lift S1-43', date: '5/1/2025' },
  { machinery: 'Scissor Lift S2-53', date: '5/1/2025' },
  { machinery: 'Zamboni', date: '5/2/2025' },
  { machinery: 'Scissor Lift S3-53', date: '5/5/2025' },
  { machinery: 'Scissor Lift S4-53', date: '5/5/2025' },
  { machinery: 'Hyster Forklift', date: '5/6/2025' },
  { machinery: 'Doosan Forklift', date: '5/7/2025' },
  { machinery: 'Scissor Lift S1-53', date: '5/8/2025' },
  { machinery: 'Scissor Lift S2-53', date: '5/8/2025' },
  { machinery: 'Scissor Lift S3-43', date: '5/9/2025' },
];

const SAMPLE_DIESEL_DATA = [
  { machinery: 'Crane', date: '1/6/2025', gallons: 44 },
  { machinery: 'Boom Lift #B1-135', date: '1/7/2025', gallons: 35 },
  { machinery: 'Boom Lift #B2-150', date: '1/10/2025', gallons: 28 },
  { machinery: 'Boom Lift #B1-150', date: '1/14/2025', gallons: 39 },
  { machinery: 'Boom Lift #B3-150', date: '1/14/2025', gallons: 17 },
  { machinery: 'Boom Lift #B3-150', date: '1/15/2025', gallons: 26 },
  { machinery: 'Boom Lift #B3-150', date: '1/26/2025', gallons: 29 },
  { machinery: 'Boom Lift #B1-150', date: '1/26/2025', gallons: 40 },
  { machinery: 'Boom Lift #B2-150', date: '1/27/2025', gallons: 24 },
  { machinery: 'Boom Lift #B4-150', date: '1/27/2025', gallons: 40 },
  { machinery: 'Crane', date: '1/27/2025', gallons: 34 },
  { machinery: 'Scissor Lift #S6-53', date: '1/28/2025', gallons: 16 },
  { machinery: 'Boom Lift #B1-135', date: '1/29/2025', gallons: 49 },
  { machinery: 'Boom Lift #B4-135', date: '2/4/2025', gallons: 50 },
  { machinery: 'Boom Lift #B3-135', date: '2/14/2025', gallons: 30 },
  { machinery: 'Boom Lift #B2-150', date: '2/14/2025', gallons: 46 },
  { machinery: 'Boom Lift #B3-150', date: '2/14/2025', gallons: 40 },
  { machinery: 'Boom Lift #B2-135', date: '2/18/2025', gallons: 41 },
  { machinery: 'Crane', date: '2/20/2025', gallons: 38 },
  { machinery: 'Boom Lift #B1-150', date: '2/21/2025', gallons: 45 },
  { machinery: 'Boom Lift #B4-150', date: '3/3/2025', gallons: 32 },
  { machinery: 'Boom Lift #B2-135', date: '3/5/2025', gallons: 37 },
  { machinery: 'Scissor Lift #S6-53', date: '3/10/2025', gallons: 18 },
  { machinery: 'Boom Lift #B3-135', date: '3/12/2025', gallons: 42 },
  { machinery: 'Boom Lift #B1-135', date: '3/15/2025', gallons: 48 },
  { machinery: 'Crane', date: '3/18/2025', gallons: 36 },
  { machinery: 'Boom Lift #B2-150', date: '3/20/2025', gallons: 43 },
  { machinery: 'Boom Lift #B4-135', date: '3/25/2025', gallons: 51 },
  { machinery: 'Boom Lift #B3-150', date: '4/2/2025', gallons: 35 },
  { machinery: 'Boom Lift #B1-150', date: '4/5/2025', gallons: 44 },
  { machinery: 'Crane', date: '4/8/2025', gallons: 39 },
  { machinery: 'Boom Lift #B2-135', date: '4/10/2025', gallons: 46 },
  { machinery: 'Scissor Lift #S6-53', date: '4/15/2025', gallons: 20 },
  { machinery: 'Boom Lift #B4-150', date: '4/18/2025', gallons: 41 },
  { machinery: 'Boom Lift #B1-135', date: '4/22/2025', gallons: 50 },
  { machinery: 'Boom Lift #B3-135', date: '4/25/2025', gallons: 38 },
  { machinery: 'Crane', date: '4/28/2025', gallons: 37 },
  { machinery: 'Boom Lift #B2-150', date: '5/1/2025', gallons: 45 },
  { machinery: 'Boom Lift #B4-135', date: '5/5/2025', gallons: 52 },
  { machinery: 'Boom Lift #B1-150', date: '5/8/2025', gallons: 42 },
  { machinery: 'Crane', date: '5/10/2025', gallons: 48 },
  { machinery: 'Boom Lift #B2-135', date: '5/12/2025', gallons: 44 },
  { machinery: 'Boom Lift #B3-150', date: '5/15/2025', gallons: 51 },
  { machinery: 'Boom Lift #B4-150', date: '5/18/2025', gallons: 39 },
  { machinery: 'Scissor Lift #S6-53', date: '5/20/2025', gallons: 22 },
  { machinery: 'Boom Lift #B1-135', date: '5/22/2025', gallons: 47 },
  { machinery: 'Crane', date: '5/25/2025', gallons: 43 },
  { machinery: 'Boom Lift #B2-150', date: '5/28/2025', gallons: 50 },
  { machinery: 'Boom Lift #B3-135', date: '6/1/2025', gallons: 45 },
  { machinery: 'Boom Lift #B4-135', date: '6/5/2025', gallons: 29 },
  // July entries - 26 gallons total
  { machinery: 'Boom Lift #B1-150', date: '7/8/2025', gallons: 13 },
  { machinery: 'Boom Lift #B2-135', date: '7/15/2025', gallons: 13 },
  // August entries - 157 gallons total
  { machinery: 'Crane', date: '8/2/2025', gallons: 40 },
  { machinery: 'Boom Lift #B3-150', date: '8/5/2025', gallons: 38 },
  { machinery: 'Boom Lift #B1-135', date: '8/10/2025', gallons: 39 },
  { machinery: 'Boom Lift #B4-150', date: '8/15/2025', gallons: 40 },
  // September entries - 187 gallons total
  { machinery: 'Boom Lift #B2-150', date: '9/3/2025', gallons: 47 },
  { machinery: 'Boom Lift #B1-150', date: '9/8/2025', gallons: 45 },
  { machinery: 'Crane', date: '9/12/2025', gallons: 48 },
  { machinery: 'Boom Lift #B3-135', date: '9/18/2025', gallons: 47 },
  // October entries - 114 gallons total
  { machinery: 'Boom Lift #B4-135', date: '10/5/2025', gallons: 57 },
  { machinery: 'Boom Lift #B2-135', date: '10/12/2025', gallons: 57 },
];

export async function GET(request: NextRequest) {
  const searchParams = request.nextUrl.searchParams;
  const type = searchParams.get('type');

  try {
    if (type === 'helium') {
      return NextResponse.json(SAMPLE_HELIUM_DATA);
    } else if (type === 'fuel') {
      return NextResponse.json({
        propane: SAMPLE_PROPANE_DATA,
        diesel: SAMPLE_DIESEL_DATA,
        propaneTotals: {
          gallonsRemaining: 200,
          gallonsPumped: 1925,
          canisters: 269,
        },
        dieselTotal: SAMPLE_DIESEL_DATA.reduce((sum, item) => sum + item.gallons, 0),
      });
    } else {
      const heliumFillTotals = calculateHeliumFillTotals();
      return NextResponse.json({
        helium: SAMPLE_HELIUM_DATA,
        heliumFillTotals: heliumFillTotals,
        fuel: {
          propane: SAMPLE_PROPANE_DATA,
          diesel: SAMPLE_DIESEL_DATA,
          propaneTotals: {
            gallonsRemaining: 200,
            gallonsPumped: 1925,
            canisters: 269,
          },
          dieselTotal: SAMPLE_DIESEL_DATA.reduce((sum, item) => sum + item.gallons, 0),
        },
      });
    }
  } catch (error) {
    console.error('Error fetching sheets:', error);
    return NextResponse.json({ error: 'Failed to fetch data' }, { status: 500 });
  }
}
